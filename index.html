<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <style type="text/css">
    .underline {
      text-decoration: underline
    }
    .center {
      text-align: center
    }
    .placeleft {
      margin-left: 330px
    }
    .border{
      border-style: solid;
      border-width: 5px;
      border-color: grey;
    }
    .hidden{
      display: none;
    }
    </style>
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');
        var title = $("<h1>Twittler</h1>").addClass('center');
        var button = $('<button>Refresh Feed</button>').addClass('placeleft');
        var feed = $('<ul> Beginning </ul>').addClass('center');
        var refresh = function() {
          $('p').remove();
          var index = streams.home.length - 1;
            while(index >= 0){
              var tweet = streams.home[index];
              var usr = $("<ul></ul>");
              var $tweet = $('<p></p>');
              var timeOf = $("<ul></ul>");
              $tweet.text(tweet.message).css({"text-align":"center", "width":"50%", "margin-left":"auto", "margin-right":"auto"});
              $(usr).text("@" + tweet.user).css({"text-align":"left"});
              $(timeOf).text(tweet.created_at).css({"text-align":"right"});
              $(timeOf).appendTo($tweet);
              $(usr).prependTo($tweet);
              $tweet.addClass(tweet.user);
              $tweet.addClass('border');
              $tweet.on('mouseenter', 'ul', function() {$(this).toggleClass('underline');})
              $tweet.on('mouseleave', 'ul', function() {$(this).toggleClass('underline');})
              usr.on('click', function(){
                var username = $(this).parent().attr('class');
                var test = $('p').first();
                for(var i = 0; i < ($('p').length); i++){
                  if(!test.hasClass(username)){
                    test.toggleClass('hidden');
                  }
                  test = test.next()
                }
              });

              $(feed).before($tweet);
              index -= 1;
            }
        }

        $(title).appendTo($body);
        $(button).appendTo($body);
        $(feed).appendTo($body);
        $("button").on('click', refresh);
        refresh();
      });

    </script>
  </body>
</html>
